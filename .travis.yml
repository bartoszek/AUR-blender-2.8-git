sudo: required

branches:
  only:
  - travis

cache:
  directories:
  - .ccache
  - AUR-repo
  - blender-addons-contrib.git
  - blender-addons.git
  - blender-dev-tools.git
  - blender-translations.git
  - blender

services:
- docker

arch:
  repos:
  - bartus=https://github.com/bartoszek/AUR-repo/raw/master
  packages:
  - ccache
  script:
  - "echo 'options+=(ccache)' >> PKGBUILD"
  - "export CCACHE_DIR='/build/.ccache'"
  - "makepkg -s --noconfirm"
  - "ccache -s"

script:
- "curl -s https://raw.githubusercontent.com/mikkeloscar/arch-travis/master/arch-travis.sh | bash"
- "CCACHE_DIR=\"$(pwd)/.ccache\" ccache -s"

deploy:
  on:
    branch: travis
  skip_cleanup: true
  provider: script
  script: bash .travis_deploy.sh
